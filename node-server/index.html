<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="https://cdn.bootcss.com/jsmpeg/0.2/jsmpg.js"></script>
	<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>
	<canvas id="videoCanvas" width="1100" height="720" style="width:1100px; height: 720px;"></canvas>
	<button onclick="close()">复制文本</button>
	<script>
		/*navigator.registerProtocolHandler("web+ws",
                                  "%s",
                                  "rtsp");*/
        $.ajax({url:"http://127.0.0.1:61234/server?rtsp=rtsp://admin:lst12345678@10.10.88.11:554/h264/ch1/main/av_stream&port=9999",async:false});
        setTimeout(function(){
			client = new WebSocket('ws://localhost:9999');
			    	var canvas = document.getElementById('videoCanvas');
			    	var player = new jsmpeg(client, {canvas:canvas, autoplay:true, loop:true});
        },2000);
        var close = function () {
        	console.log("???")
        	//$.ajax({url:"http://127.0.0.1:61234/server?close=true",async:false});
        }

    	// client4 = new WebSocket('ws://localhost:9994');
    	// 	var client4 = document.getElementById('videoCanvas4');
    	// 	var player = new jsmpeg(client4, {canvas:client4, autoplay:true, loop:true});

    	// client5 = new WebSocket('ws://localhost:9993');
    	// 	var client5 = document.getElementById('videoCanvas5');
    	// 	var player = new jsmpeg(client5, {canvas:client5, autoplay:true, loop:true});

		/*var ice = {
		    'iceServers': [
		        {'url': 'ws://localhost:9999'},   // google公共测试服务器
		        // {"url": "turn:user@turnservera.com", "credential": "pass"}
		    ]
		};

		// var signalingChannel =  new SignalingChannel();

		var pc = new RTCPeerConnection(ice);*/


		/*navigator.getUserMedia = navigator.getUserMedia ||
    	navigator.webkitGetUserMedia || navigator.mozGetUserMedia;

		var constraints = { // 音频、视频约束
		  audio: true, // 指定请求音频Track
		  video: {  // 指定请求视频Track
		      mandatory: { // 对视频Track的强制约束条件
		          width: {min: 320},
		          height: {min: 180}
		      },
		      optional: [ // 对视频Track的可选约束条件
		          {frameRate: 30}
		      ]
		  }
		};

		var video = document.querySelector('video');

		function successCallback(stream) {
		  if (window.URL) {
		    video.src = window.URL.createObjectURL(stream);
		  } else {
		    video.src = stream;
		  }
		}

		function errorCallback(error) {
		  console.log('navigator.getUserMedia error: ', error);
		}

		navigator.getUserMedia(constraints, successCallback, errorCallback);



		
		ws.onmessage = data => {
			// player.src = data.data
			// stream = new MediaStream(ws)
			console.log(stream)
		}*/

	</script>
</body>
</html>